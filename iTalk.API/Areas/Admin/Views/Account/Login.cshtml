@model iTalk.API.Models.AccountViewModel

@{
    ViewBag.Title = "登入";
}

<div>
    <div class="form-group">
        <div class="inline-block">
            <h4 class="">登入</h4>
        </div>
    </div>
    @Html.ValidationMessage("", null, new { @class = "text-danger" })
    <div class="form-group">
        @Html.ValidationMessageFor(m => m.UserName, null, new { @class = "text-danger" })
        @Html.TextBoxFor(m => m.UserName, new { @class = "form-control", placeholder = "使用者名稱", id = "username" })
    </div>
    <div class="form-group">
        @Html.ValidationMessageFor(m => m.Password, null, new { @class = "text-danger" })
        @Html.PasswordFor(m => m.Password, new { @class = "form-control", placeholder = "密碼", id = "password" })
    </div>
    <div class="form-group">
        <input type="submit" value="登入" class="btn btn-primary" />
    </div>
</div>
@section scripts {
    <script type="text/javascript">
        $("input[type='submit']").click(function() {
            var loginData = {
                grant_type: "password",
                username: $("#username").val(),
                password: $("#password").val()
            };

            $.ajax({
                type: "POST",
                url: "/Token",
                data: loginData
            })
            .success(function () {
                window.location.href = "@ViewBag.ReturnUrl";
            })
            .fail(function (err) {
                alert(err.responseText);
            });
        });
    </script>
}